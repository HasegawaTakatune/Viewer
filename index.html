<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>File Viewer</title>
    <script src="https://www.promisejs.org/polyfills/promise-7.0.4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
</head>

<body>
    <div id="app">
        <div>
            <p>間隔</p>
            <input type="radio" name="interval" id="interval-1" value=1 @click="ResetInterval(1)" checked />
            <label for="interval-1">1秒</label>
            <input type="radio" name="interval" id="interval-10" value=10 @click="ResetInterval(10)" />
            <label for="interval-10">10秒</label>
            <input type="radio" name="interval" id="interval-30" value=30 @click="ResetInterval(30)" />
            <label for="interval-30">30秒</label>

        </div>

        <table>
            <thead>
                <tr>
                    <th v-for="(row, index) in headers" :key="index">{{row}}</th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="(rows, index) in response" :key="index">
                    <td v-for="(row, key) in rows" :key="key">{{row}}</td>
                </tr>
            </tbody>
        </table>
    </div>
    <script>
        var app = new Vue({
            el: '#app',
            name: 'Viewer',
            data: {
                headers: ['No.', '年月日', '時刻', 'データ'],
                interval: 1,
                url: '',
                response: null,

                methodId: null,
            },

            methods: {
                GetFile() {
                    let self = this;
                    let now = new Date();
                    self.response = [
                        { no: '1', day: 'XX/XX/XX', time: 'XX:XX:XX', data: '123' },
                        { no: '2', day: 'XX/XX/XX', time: 'XX:XX:XX', data: '123' },
                    ];
                    // axios.get(self.url)
                    //     .then(
                    //         res => {
                    //             self.response = [
                    //                 { no: '0001', day: now.format('YYYY/MM/DD'), time: now.format('hh:mm:ss'), data: 'SAMPLE' },
                    //                 { no: '0002', day: now.format('YYYY/MM/DD'), time: now.format('hh:mm:ss'), data: 'SAMPLE' }
                    //             ] // res.data;
                    //         }
                    //     )
                    //     .catch(e => {
                    //         console.error(e);
                    //     })

                    this.methodId = setTimeout(this.GetFile, this.interval * 1000)
                },

                ResetInterval(interval) {
                    this.interval = interval;

                    clearTimeout(this.methodId);
                    this.GetFile();
                },
            },

            mounted() {
                this.GetFile();
            },

            beforeDestroy() {
                clearTimeout(this.GetFile);
            },
        });
    </script>
    <style>
        table * {
            border: 1px double black;
        }
    </style>
</body>

</html>